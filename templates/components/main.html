<script>
angular.module('ttPoker', [])
.controller('controller',function($scope){
  var naipes = ['♣','♦','♥','♠'];
  var valores = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
  $scope.cartas = [];
  $scope.jogadores = 2;
  indexCartas = 0;
  

  gerarBaralho();
  loadCartas();

  function gerarBaralho(){
    baralho = [];
    naipes.map((naipe) =>{
      valores.map((v) =>{
        baralho.push({
          naipe: naipe,
          valor: v,
          especial:false,
          index: getUniqueKey()
        });
      });
    });
    for(var x = 0; x < 4; x++){
      baralho.push({
        naipe: null,
        valor:'thief', //ladrão
        especial : true,
        index: getUniqueKey()
      });
      baralho.push({
        naipe: null,
        valor:'joker', //coringa$scope.yourName = "Lucas"
        especial : true,
        index: getUniqueKey()
      });
    }
    console.log(baralho);
  }

  function getCartaAleatoria(){
    var posicao = Math.floor(Math.random() * baralho.length);
    var carta = baralho[posicao]
    baralho.splice(posicao, 1);
    console.log(baralho.length);
    return carta;
  }

  function loadCartas(){
    for(var x = 0; x < 5 ; x ++){
      $scope.cartas.push(getCartaAleatoria());
    }
  }

  function getUniqueKey(){
    indexCartas += 1;
    return indexCartas;
  }

  $scope.isRed = function(carta){
    if(carta == null || carta.naipe == null){
      return false;
    }
    if(carta.naipe.includes(['♦']) || carta.naipe.includes(['♥']))
      return true;
    else
      return false;
  }

  $scope.changeCard = function(carta){
    var i = $scope.cartas.indexOf(carta);
    $scope.cartas[i] = getCartaAleatoria();
  }




})
</script>